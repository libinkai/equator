# YUM

- 安装软件到指定目录

  ```
  yum -c /etc/yum.conf --installroot=/usr/local --releasever=/  install XXX
  # 修改yum安装目录（releasever发行版本）

  ```

- 更换源头

  ```
  // 备份
  mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
  // 更换
  wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
  // 缓存
  yum makecache
  ```

# 防火墙

> 一般较新版本的Linux镜像使用firewall（7.0以上）

## iptables

- 配置文件路径 `/etc/sysconfig/iptables`

## firewall

### 常用命令

- 查看防火墙状态：firewall-cmd --state
- 开启防火墙：systemctl start firewalld 
- 关闭防火墙：systemctl stop firewalld
- 设置开机启动：systemctl enable firewalld
- 停止并禁用开机启动：sytemctl disable firewalld
- 重启防火墙：firewall-cmd --reload

### 开启某个范围的端口号

```
- firewall-cmd --zone=public --add-port=18881:65534/tcp --permanent
- firewall-cmd --reload    # 重新启动防火墙
```

### 开启端口

```
firewall-cmd --zone=public --add-port=80/tcp --permanent
- firewall-cmd --reload    # 重新启动防火墙
```

#### 参数说明：

- zone 作用域
- add-port=8080/tcp 添加端口，格式为：端口/通讯协议
- permanent #永久生效，没有此参数重启后失效

### 查看指定区域所有开启的端口号

firewall-cmd (--zone=public) --list-ports

# SERVICE | SYSTEMCTL

# VIM

# JDK

## yum安装

- 查看yum库中的Java安装包
  yum -y list java*
- 使用yum安装Java环境，安装java-1.8.0版本的所有相关程序
  yum -y install java-1.8.0-openjdk*

## wget安装JDK

- wget --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u141-b15/336fa29ff2bb4ef291e347e091f7f4a7/jdk-8u141-linux-x64.tar.gz"
- vim /etc/profile    # 配置环境变量

```
JAVA_HOME=/usr/java/jdk1.8.0_60
CLASSPATH=$JAVA_HOME/lib/
PATH=$PATH:$JAVA_HOME/bin
export PATH JAVA_HOME CLASSPATH
```

- source /etc/profile    # 使配置文件生效

# MYSQL

## 安装

### yum安装

1. 添加仓库

   ```shell
   // 添加仓库
   sudo rpm -ivh https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm

   // 确认是否添加成功
   sudo yum repolist all | grep mysql | grep enabled

   ```

2. 安装mysql

   ```
   sudo yum -y install mysql-community-server

   ```

3. 启动

   ```
   sudo systemctl start mysqld

   sudo systemctl enable mysqld

   sudo systemctl status mysqld
   ```

   

## 备份（结构+数据）

```
mysqldump -uroot -p123456 -A > path    # 全量备份
mysqldump -uroot -p123456 database > path    # 指定库备份
mysqldump -uroot -p123456 -- databases db1, db2 > path    # 多库备份
```

## 还原数据

```
# 还原全部数据库
mysql> source path
mysql -uroot -p 123456 < path

还原指定数据库
mysql> use db;source path
mysql -uroot -p123456 db < path
```

## 允许远程登录

1. 先保证防火墙已开启对应的端口，如果是云主机，则要配置安全组并绑定到你的实例上面

   ```
   iptables -I INPUT 4 -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT
   service iptables save #保存iptables规则
   ```

2. 登录mysql，选择mysql数据库

   ```
   mysql -uroot -p

   use mysql;
   ```

3. 执行sql语句（查询主机和用户名）

   ```
   select host,user from user;
   ```

4. 将其中一个记录（一般是修改自己新建的host）的host值改为%

   ```
   update user set host = '%' where host='localhost' and user = 'root';
   ```

5. 刷新权限表或者重启mysql

   ```
   flush privileges;
   ```

## 初始化密码

```
You must reset your password using ALTER USER statement before executing this statement.

// 这样初始化的密码好像无法登录
alter user 'root'@'localhost' identified by 'youpassword';

flush privileges;
```



## 密码过期

```
// 查看过期策略
select user,host,password_expired from user;

// 修改策略
update user set password_expired = 'N' where user = 'root';

// 刷新权限表
flush privileges;
```



## 修改密码

1. 停止mysql服务进程

   ```
   service mysqld stop
   ```

2. 编辑mysql的配置文件my.cnf

   ```
   vim /etc/my.cnf     

   # 找到 [mysqld]这个模块在后面添加一段代码
   skip-grant-tables    # 忽略mysql权限问题，直接登录
   ```

3. 保存并退出Vim编辑器，重启mysql服务

   ```
   service mysqld start
   ```

4. 进入mysql

   ```
   mysql
   
   use mysql;
   
   update user set password=password("121312321") where user="root";##更新密码 
   
   # 有的版本中密码字段是authentication_string而不是password，注意分辨
   # update user set authentication_string = password('123456') where host='localhost' and user = 'root';
   
   flush privileges;
   
   quit;
   
   # ALTER USER 'root'@'localhost' IDENTIFIED WITH MYSQL_NATIVE_PASSWORD BY 'kindergartenmysql';
   ```

5. 修改my.cnf文件，将之前添加的skip-grant-tables删除，并重启mysql服务

# REDIS

## 安装

## 其它

- 如果是使用现有镜像，已经安装好的Redis服务，操作Redis服务时，应该使用

  ```
  service redis-server start|stop|restart
  ```

# NGINX

## 安装

## 其它

- /usr/local/nginx/nginx -t 检查配置文件语法

# GIT

- 记住密码

  ```
  git config --global credential.helper store
  ```

  

## 安装

# MAVEN

## 安装

```
wget http://repos.fedorapeople.org/repos/dchen/apache-maven/epel-apache-maven.repo -O /etc/yum.repos.d/epel-apache-maven.repo
yum -y install apache-maven
```

# TOMCAT

## 安装

- yum install tomcat tomcat7-webapps tomcat7-admin-webapps
- service tomcat start

# 常用命令

- 查看ip地址

  ```
  ip addr 或者 ifconfig
  ```

- 查看服务监听端口

  ```
  netstat -ntlp
  ```

- 查看已安装软件

  ```
  yum list installed
  ```

- 查看软件安装位置

  ```
  whereis nginx
  ```
# 常见问题解决方案
## 无ip

> 一般是自己玩虚拟机的时候可能会遇到

1. 网络状态改为桥接模式
2. vi /etc/sysconfig/network-scripts/ifcfg-eth0
3. 将onboad=no改为onboad=yes （onboot）
4. 重启网络`service network restart`