# 备份的分类

## 按备份方法

- 热备份 在线备份
- 冷备份 离线备份
- 温备份 加全局锁在线备份

## 按备份后文件类型

- 逻辑备份：备份文件可读，一般是文本文件，由SQL语句组成
  - `mysqldump`
  - `select * from outfile`
- 裸文件备份：复制物理文件
  - `ibbackup`
  - `xtrabackup`

## 按备份数据库的内容

- 完全备份：对数据库进行整库备份
- 增量备份：在上次完全备份基础上对更改的部分备份
- 日志备份：对MYSQL数据库二进制日志文件的备份，通过对一个完全备份进行二进制日志的重做来完成数据库的point in time恢复

# 冷备份

- 复制MySQL数据库的frm文件、共享表空间文件、独立表空间文件ibd、重做日志、配置文件my.cnf

# 逻辑备份

## mysqldump

- 语法`mysqldump [arguments] >file_name`
  - `--all-databases`备份所有数据库
  - `--databases db1 db2 db3...`备份指定数据库
  - `--single-transaction`获取一致性备份

## SELECT ... INTO OUTFILE

## 恢复

- `mysql -uroot -p < backup.sql`
- 或者进入MYSQL执行 `source`命令

# 二进制日志备份与恢复

- 配置文件`log-bin=mysql-bin`开启
- `FLUSH LOGS`生成新的二进制文件
- `mysqlbinlog`还原二进制日志

# 热备份

## ibbackup 商用

## XtraBackup 开源

# 快照备份

> 使用操作系统的快照功能

# 复制

## 原理

1. 主服务器把数据更改记录到二进制日志`binlog`中
2. 从服务器把二进制文件复制到自己的中继日志中
3. 从服务器重做中继日志的日志，把更改应用到自己的数据库上，以达到数据的`最终一致性`