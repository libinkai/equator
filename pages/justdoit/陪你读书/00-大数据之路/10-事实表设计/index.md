# 事实表设计

> 本文内容摘录于《大数据之路：阿里巴巴大数据实践》。

## 事实表基础

### 特性

- 事实表是数据仓库维度建模的核心，与业务紧密相连，通过获取描述业务过程的度量来表达业务过程，包含了引用的维度和与过程有关的度量。
- 相对维表来说，通常事实表比维表细长得多，数据行的增加速度也比维表快。
- 维度属性也可以存储到事实表中，作为“退化维度”。退化维度可以作为事实表的过滤条件，实现聚合操作。

### 设计原则

- 尽可能包含所有与业务过程相关的事实，以便满足分析需求。
- 只选择与业务过程相关的事实，不包含其它业务过程事实以面耦合过高，如订单下单业务过程的事实表，不应该包含支付金额这个属于支付过程的事实。
- 分解不可加性事实为可加的组件，如将订单的优惠率分解为订单原价与订单优惠金额。
- 选择维度与事实之前须明确粒度，粒度指的是表达业务的细节程度，每个维度和事实必须与所定义的粒度保持一致。
- 同一个事实表中不能包含多种不同粒度的事实。

![image-20210803080642534](image-20210803080642534.png)

- 事实单位需要保持一致，对空值使用零值填充，适当使用退化维度提高事实表的易用性。

### 设计方法

## 事务事实表

### 设计过程

### 单事务事实表

### 多事务事实表

### 二者对比

### 父子事实

### 设计准则

## 周期性快照事实表

### 特性

### 实例

### 注意事项

## 累积快照事实表

### 设计过程

### 特点

### 特殊处理

### 物理实现

## 三种事实表比较

## 无事实的事实表

## 聚集型事实表

### 聚集的基本原则

### 聚集的基本步骤

### 公共汇总层

