# 日志采集

- 日志即数据，日志采集即数据采集，它是大数据处理的第一个环节，十分重要。

## 浏览器日志采集

- 浏览器即PC端，主要分为浏览日志采集以及交互日志采集，前者是页面加载时采集的日志；后者是页面加载完毕后，在页面上的操作记录。
- 浏览日志的采集时机主要是某个节点（或者页面）加载完毕后，这样可以确保页面已经被正常打开访问。日志采集的代码可以是服务器在返回HTML文档前动态地植入，也可以是前端开发时由前端程序员植入HTML文档中。
- 交互日志灵活性高，处理流程主要是：业务方在“黄金令箭”平台注册需要具体采集哪些数据（如播放视频的名称、播放时长），生成对应的代码并植入到页面中进行绑定操作。当用户发生交互行为时，通过事件监听机制即可将对应的交互日志采集起来。
- 上面说到的“黄金令箭”平台，具有**埋点管理系统**的功能。一般我们将某个数据采集点称为“埋点”，其中的数据表明了交互行为发生的时间、位置、用户信息等数据。在埋点管理系统中注册埋点元数据，是后续进行统一管理、优化埋点的前提。

## 无线客户端日志采集

- 无线客户端的日志采集一般使用SDK实现，也可以分为页面事件（浏览日志）以及控件点击等事件（交互日志）。
- 页面事件一般是在打开页面时采集一次数据并缓存下来，离开页面时再采集一次数据，通过计算即可得到用户的停留时间。
- 控件点击事件以及自定义事件，记录了用户具体的交互行为数据。
- SDK要做的工作，绝不仅仅是收集日志，其还需要对日志进行聚合以及缓存等操作，聚合可以减少日志的数量以及大小，缓存则可以减少网络请求次数。

## 挑战

- 随着公司的发展，数据越来越多，如何结构化以及规范化地采集数据，也是不得不考虑的事情了。数据作为重要的资源，精细化的管理必定会取代粗放式的使用。
- 日志需要业务分流（各业务相互不影响，一个业务突增的日志量不应该影响其它业务）、日志优先级控制以及定制化处理等。具体实现是使得路由差异化，提前进行分流（可以认为是剪枝），同时对特殊业务进行特殊处理，降级成本提高可用性。
- 大促保证：阿里著名的“双十一”等活动，需要进行全链路的保障。